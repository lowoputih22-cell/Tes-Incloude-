<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Dashboard</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  display:flex;
  height:100vh;
}

/* sidebar */
#sidebar{
  width:260px;
  background:#0f172a;
  color:white;
  padding:15px;
  overflow:auto;
}

#sidebar h2{
  text-align:center;
}

.menu{
  padding:10px;
  margin:6px 0;
  background:#1e293b;
  cursor:pointer;
  border-radius:6px;
}

.menu:hover{
  background:#334155;
}

button{
  width:100%;
  padding:10px;
  margin-top:10px;
  border:none;
  background:#22c55e;
  color:white;
  border-radius:6px;
  cursor:pointer;
}

button:hover{
  background:#16a34a;
}

/* konten */
#content{
  flex:1;
  padding:20px;
  overflow:auto;
}

/* popup */
#popup{
  position:fixed;
  top:0;
  left:0;
  right:0;
  bottom:0;
  background:rgba(0,0,0,0.6);
  display:none;
  align-items:center;
  justify-content:center;
}

#popupBox{
  background:white;
  padding:20px;
  width:320px;
  border-radius:10px;
}
</style>
</head>

<body>

<div id="sidebar">
  <h2>MENU</h2>

  <div id="menuList"></div>

  <button onclick="bukaPopup()">+ Tambah Menu</button>
</div>

<div id="content">
  <h2>Dashboard siap</h2>
  Pilih menu di kiri.
</div>

<!-- POPUP -->
<div id="popup">
  <div id="popupBox">
    <h3>Tambah Menu</h3>

    Nama Menu:
    <input type="text" id="namaMenu" style="width:100%;padding:8px">

    <br><br>
    Pilih File:
    <select id="fileSelect" style="width:100%;padding:8px"></select>

    <br><br>
    <button onclick="tambahMenu()">Tambah</button>
    <button onclick="tutupPopup()" style="background:red;margin-top:5px">Batal</button>
  </div>
</div>

<script>
// =============================
// CONFIG
const username = "lowoputih22-cell";
const repo = "Tes-Incloude-";
const folder = "Menu";
// =============================

const apiUrl = `https://api.github.com/repos/${username}/${repo}/contents/${folder}`;

// load menu dari localStorage
function loadMenu(){
  let data = JSON.parse(localStorage.getItem("menus")||"[]");
  let html="";

  data.forEach(item=>{
    html += `<div class="menu" onclick="loadPage('${item.url}')">${item.nama}</div>`;
  });

  document.getElementById("menuList").innerHTML = html;
}
loadMenu();

// buka popup
function bukaPopup(){
  document.getElementById("popup").style.display="flex";
  loadFileList();
}

function tutupPopup(){
  document.getElementById("popup").style.display="none";
}

// ambil daftar file di folder Menu
function loadFileList(){
  fetch(apiUrl)
  .then(res=>res.json())
  .then(files=>{
    let opt="";
    files.forEach(file=>{
      if(file.name.endsWith(".html")){
        opt += `<option value="${file.download_url}">${file.name}</option>`;
      }
    });
    document.getElementById("fileSelect").innerHTML = opt;
  });
}

// tambah menu
function tambahMenu(){
  let nama = document.getElementById("namaMenu").value;
  let url = document.getElementById("fileSelect").value;

  if(nama===""){
    alert("Isi nama menu dulu");
    return;
  }

  let data = JSON.parse(localStorage.getItem("menus")||"[]");
  data.push({nama:nama,url:url});
  localStorage.setItem("menus",JSON.stringify(data));

  tutupPopup();
  loadMenu();
}

// load isi halaman
function loadPage(url){
  fetch(url)
  .then(res=>res.text())
  .then(html=>{
    document.getElementById("content").innerHTML = html;
  });
}
</script>

</body>
</html>
